STEP 2 
Code for Further Data cleaning and Data Prep to capture in Year 2016-2019 
Code was repeated on all the Individual yearly files 2016-2019

**************************************************************************************************

*FL AHCA 2016

use "file path 2016 Data"
append using "file path 2017 Data"
append using "file path 2018 Data"
append using "file path 2019 Data"

drop  POA_ECMORB1 POA_ECMORB2 POA_ECMORB3 

tab DISCHSTAT YEAR 

tab DISCHSTAT if PRINPROC == ""

codebook PRINPROC if YEAR == 2016 | YEAR == 2017 | YEAR == 2018 | YEAR == 2019 | YEAR == 2015 & QTR == "4" 

mdesc PRINPROC if YEAR == 2016 | YEAR == 2017 | YEAR == 2018 | YEAR == 2019 | YEAR == 2015 & QTR == "4" 

codebook PRINDIAG 

codebook PRINDIAG if YEAR == 2016 | YEAR == 2017 | YEAR == 2018 | YEAR == 2019 | YEAR == 2015 & QTR == "4" 

save "file path", replace 

**************************************************************************************************
*Reading the File from above 

use "file path 2016 Data"

tab ADM_PRIOR

mdesc PRINPROC


drop if AGE<18
drop if AGE==.
drop if AGE==777
drop if AGE==999

tab DISCHSTAT if AGE == 888

drop if AGE == 888 


drop POA1 POA2 POA3 POA4 POA5 POA6 POA7 POA8 POA9 POA10 POA11 POA12 POA13 POA14 POA15 POA16 POA17 POA18 POA19 POA20 POA21 POA22 POA23 POA24 POA25 POA26 POA27 POA28 POA29 POA30

drop DAYS_PROC1 DAYS_PROC2 DAYS_PROC3 DAYS_PROC4 DAYS_PROC5 DAYS_PROC6 DAYS_PROC7 DAYS_PROC8 DAYS_PROC9 DAYS_PRO_A DAYS_PRO_B DAYS_PRO_C DAYS_PRO_D DAYS_PRO_E DAYS_PRO_F DAYS_PRO_G DAYS_PRO_H DAYS_PRO_I DAYS_PRO_J DAYS_PRO_K DAYS_PRO_L DAYS_PRO_M DAYS_PRO_N DAYS_PRO_O DAYS_PRO_P DAYS_PRO_Q DAYS_PRO_R DAYS_PRO_S DAYS_PRO_T DAYS_PRO_U ECMORB1 ECMORB2 ECMORB3 POA_ECMORB POA_ECMO_A POA_ECMO_B DAYS_PROC10 DAYS_PROC11 DAYS_PROC12 DAYS_PROC13 DAYS_PROC14 DAYS_PROC15 DAYS_PROC16 DAYS_PROC17 DAYS_PROC18 DAYS_PROC19 DAYS_PROC20 DAYS_PROC21 DAYS_PROC22 DAYS_PROC23 DAYS_PROC24 DAYS_PROC25 DAYS_PROC26 DAYS_PROC27 DAYS_PROC28 DAYS_PROC29 DAYS_PROC30 COMPREHABC COMPREHABCHGS

drop POA_PRIN_D ECODE1 ECODE2 ECODE3 POA_EXT_IN POA_EXT__A POA_EXT__B CONDTN

drop POA_PRIN_DIAG ATTEN_PHYID ATTEN_PHYNPI OPER_PHYNPI OTHOPER_PHYID OTHOPER_PHYNPI OPER_PHYNP OTHOPER_PH OTHOPER__A

drop PRO_CODE FAC_REGION ADM_PRIOR EDHR_ARR ADM_TIME DIS_TIME PTSTATE PTCOUNTY PTCOUNTRY ADMITDIAG

replace MOD_CODE = "CL01" if MOD_CODE == "CL00" 
replace MOD_CODE = "CL01" if MOD_CODE == "" 

drop HIV LIVERSEVERE PARALYSIS PUD DEMENTIA

drop POA_ECMORB1 POA_ECMORB2 POA_ECMORB3


drop EQUIPMENT_FAILURE NONPERFORMED_PROC REATTACHMENT_AMPUTATED_PART INJURY_PROCEDURES ANAPHYLACTIC_SHOCK ALLERGY SHOCK COMPLICATIONS_ABORTION OTHER_KIDNEY PRESSURE_ULCERS ARTERIES_DISORDERS FALL MECHANICAL_IMPLANTATION CEREBRAL_INFRACTION ANAESTHESIA EMBOLISM BLEEDING RUPTURE CLOSTRIDIUM_DIFFICILE PERICARDITIS MENINGITIS BACTERIAL_INTESTINAL SURGICAL_SITE CARDIOVASCULAR_SHOCK CARDIAC_ARREST ANGINA_PECTORIS PNEUMOTHORAX

drop if PRINPROC == ""

drop DELIRIUM_SOMNOLENCE PULMONARY_OEDEMA

keep if DAYSPROC == 0 


drop OTHDIAG1 OTHDIAG2 OTHDIAG3 OTHDIAG4 OTHDIAG5 OTHDIAG6 OTHDIAG7 OTHDIAG8 OTHDIAG9 OTHDIAG10 OTHDIAG11 OTHDIAG12 OTHDIAG13 OTHDIAG14 OTHDIAG15 OTHDIAG16 OTHDIAG17 OTHDIAG18 OTHDIAG19 OTHDIAG20 OTHDIAG21 OTHDIAG22 OTHDIAG23 OTHDIAG24 OTHDIAG25 OTHDIAG26 OTHDIAG27 OTHDIAG28 OTHDIAG29 OTHDIAG30

drop OTHPROC1 OTHPROC2 OTHPROC3 OTHPROC4 OTHPROC5 OTHPROC6 OTHPROC7 OTHPROC8 OTHPROC9 OTHPROC10 OTHPROC11 OTHPROC12 OTHPROC13 OTHPROC14 OTHPROC15 OTHPROC16 OTHPROC17 OTHPROC18 OTHPROC19 OTHPROC20 OTHPROC21 OTHPROC22 OTHPROC23 OTHPROC24 OTHPROC25 OTHPROC26 OTHPROC27 OTHPROC28 OTHPROC29 OTHPROC30

drop FAC_CITY FAC_COUNTY

drop ROOMCHGS NUR1CHGS NUR2CHGS NUR3CHGS ICUCHGS CCUCHGS PHARMCHGS MEDCHGS ONCOCHGS LABCHGS RADCHGS OPRMCHGS ANESCHGS RESPCHGS PHYTHCHGS OCCUPCHGS SPEECHGS ERCHGS CARDIOCHGS TRAUMACHGS RECOVCHGS LABORCHGS OBSERCHGS BEHAVCHGS OTHERCHGS TCHGS

drop ATTEN_PHYI ATTEN_PHYN

drop if OPER_PHYID  == ""

drop CCI MSDRG

destring DISCHARGES, generate(DISCHARGES_n)
mdesc DISCHARGES DISCHARGES_n
drop DISCHARGES
rename DISCHARGES_n DISCHARGES


gen mortality = 1 if DISCHSTAT == "20"
replace mortality = 0 if mortality == .

tab mortality 

gen Aweekend = 1 if WEEKDAY == "7" | WEEKDAY == "6"
replace Aweekend = 0 if Aweekend == . 

tab Aweekend 

drop WEEKDAY

order YEAR QTR PRINPROC SYS_RECID PRINDIAG FACLNBR FAC_NAME MCARE_NBR DISCHSTAT ZIPCODE OPER_PHYID MOD_CODE, last 


gen ETHNICITY2 = "" 
replace ETHNICITY2  = "Hispanic Latino" if ETHNICITY == "E1"
replace ETHNICITY2  = "A_NonHispanic" if ETHNICITY == "E2"

gen RACE2 = "" 
replace RACE2  = "A_White" if RACE == "5"
replace RACE2  = "A_White" if RACE == "7"
replace RACE2  = "B_Black" if RACE == "3"
replace RACE2  = "C_Asian" if RACE == "2"
replace RACE2  = "D_AmericanIndian" if RACE == "1"
replace RACE2  = "E_Hawaiian_Pacific" if RACE == "4"
replace RACE2  = "F_Other" if RACE == "6"


drop RACE
rename RACE2 RACE


summarize AGE

gen Age1 = 1 if AGE <=30
replace Age1 = 2 if AGE >=31 & AGE <=50
replace Age1 = 3 if AGE >= 51 & AGE <=70
replace Age1 = 4 if AGE >= 71 & AGE <=90
replace Age1 = 5 if AGE >= 91

tab Age1
rename Age1 Age_Cat

tab QTR YEAR

save "file path", replace 

**************************************************************************************************









